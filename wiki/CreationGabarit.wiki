#labels Documentation
= Création d'un nouveau gabarit de page =

<h2><u>Creation du gabarit ou plugin</u></h2>

<h3>Création des fichiers et des dossiers</h3>

<ul>
 <li> Commencez par vous rendre dans le dossier _plugins_ ("_nomDuProjet/include/plugins_") de votre projet.</li>
 <li> Créez-y un dossier, avec pour nom le nom de votre futur plugin(pas d'espace ni de caractère spécial).</li>
 <li> Créez-y le fichier PHP qui va générer le gabarit. De préférence un nom évocateur comme "genNomDuPlugin".</li>

<h4>Dans le fichier créé</h4>

Dans ce fichier, déclarez votre classe. La classe créée doit étendre la classe _ocmsGen_ ou la classe _ocmsPlugin_.
  La fonction _init()_ et _afterInit()_ seront automatiquement appelées avant la fonction _gen()_. Elles ne doivent rien retourner et ne rien afficher.
  La fonction _gen()_ retournera le code du gabarit/plugin à afficher.<br/>
  <b>ATTENTION : le fichier PHP générant le gabarit doit porter le même nom que la classe déclarée et aucune fonction ne doit porter le même nom que la classe</b>

Créez dans la classe les fonctions _init()_ (facultatif) et _gen()_.

Vous devriez obtenir quelque chose comme :
<code>
class genTest extends ocmsGen
{
 public function init() {
  //Do something
 }
 public function gen() {
  //Return something
 }
}
</code>

 * Créez un fichier PHP front.php qui sera automatiquement parcouru. Vous pourrez y déclarer vos classes utiles au fonctionnement du plugin.

 * Créez, toujours dans le même dossier, un dossier qui va contenir le template du gabarit ("tpl" par exemple).
 * Créez dans le dossier "tpl" le template PHP ("nomDuPlugin.php" par exemple)

[http://www.opixido.com/ocms/screen/gabarit/gabarit-arbo.png]



<h2><u>Installation du gabarit ou du plugin</u></h2>

<h3>Enregistrement dans la table "s_gabarit"</h3>

Deux méthodes sont possibles : 

 * Directement dans le système de gestion de BD :

  # Dans la table "s_gabarit" de votre base de données, créez une nouvelle ligne.
  # Insérez les champs suivants :
|| _ gabarit_id _ || _ gabarit_titre _ || ... || _ gabarit_classe _ || ... || _ gabarit_plugin _ ||
|| ... || titre du gabarit || ... || titre de la classe || ... || nom du dossier ||

 * A partir du Back-Office
  # Ajouter le paramètre "&curTable=s_gabarit" à la fin de l'url
  # Cliquez sur "Ajouter un élément"
  # Renseignez le titre du gabarit/plugin, le nom de la classe, des paramètres (facultatif), et le nom du dossier contenant le gabarit/plugin.


<h3>Installer le plugin</h3>

 * Rendez-vous sur la page d'administration de votre site 
 * Cliquez sur le lien "Plugins" dans "Dev".
 * Sélectionnez "Ajouter un élément", sélectionnez votre nouveau plugin, puis enregistrez. Cliquez ensuite sur "Installer".

<h3>Attribuer un gabarit à une page</h3>

 * Rendez-vous dans la gestion du contenu et sélectionnez la page où vous souhaitez insérer votre nouveau gabarit.
 * Cliquez sur "Modifer"
 * Dans l'onglet "Paramètres", sélectionnez votre nouveau gabarit (champ "gabarit spécial"), puis enregistrez et validez.


<h2><u>La configuration</u></h2>

 * Créez dans le dossier de votre plugin le fichier PHP "config.php".
  ( C'est dans ce fichier que vous configurerez l'affichage et la gestion du plugin dans le back-office )


*Pour ajouter ensuite dans le back-office la gestion de votre gabarit/plugin, rendez-vous sur <u>[GabaritBO cette page]</u>*