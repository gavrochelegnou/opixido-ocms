= L'ajout d'actions et de pages dans le Back-Office =

== Ajouter une action ==

=== Ajouter une action dans le menu de droite ===
("Actions administrateur")

<code>$_Gconfig['globalActions'][]= 'nomFonction';</code>

Vous pourrez ensuite créer la fonction, qui va par exemple charger une page :

<code>
function nomFonction()
{
 //On peut inclure des fichiers
 $GLOBALS['gb_obj']->includeFile('fichier.php','plugins/nomPlugin/');
 //On affiche ce que doit contenir la page
 echo'Ma nouvelle page';
}
</code>

=== Ajouter une action sur une table ===

Pour ajouter une action *sur une table* :
<code>$_Gconfig['tableActions']['nomTable'][] = 'nomFonction';</code>

=== Ajouter une action sur les lignes d'une table ===

<code>
//Ajoute le lien de l'action/bouton
$_Gconfig['rowActions']['nomTable']['nomAction']= true;
//Ajoute une image pour ce lien/bouton
$admin_trads['src_nomAction']['fr'] = ADMIN_PICTOS_FOLDER."24x24/mimetypes/image.png";
</code>

Le nom de la classe doit obligatoirement commencer par "genAction" et implémenter la classe "ocms_action".

<code>
class genActionNomAction extends ocms_action
{
 //Vérification avant action
 public function checkCondition() {  }

 //Code de l'action
 public function doIt() { }
}
</code>

=== Ajouter une action "afficher/masquer" ===

Si votre table contient un champ "en_ligne", vous pouvez ajouter facilement un lien/bouton pour masquer ou afficher une ligne :
<code>$_Gconfig['hideableTable'][] = 'nomTable';</code>

=== Ajouter une action "Valider" ===

Votre table doit contenir les champs : "fk_version" et "en_ligne" avant de pouvoir ajouter un bouton "Valider".
Puis ajoutez :

<code>$_Gconfig['multiVersionTable'][] = 'nomTable';</code>

== Exécuter une action lors d'une modification ==

<code>
$gr_on['beforeDelete']['nomDuChamp'] = 'nomFonction';
$gr_on['insert']['nomDuChamp'] = 'nomFonction';
$gr_on['hideObject']['nomDuChamp'] = 'nomFonction';
$gr_on['showObject']['nomDuChamp'] = 'nomFonction';
$gr_on['recorded']['nomDuChamp'] = 'nomFonction';
$gr_on['fileUploaded']['nomDuChamp'] = 'nomFonction';

$_Gconfig['reloadOnChange'][] = 'nomChamp';
//La fonction doit retourner une chaîne de caractères comportant une condition SQL
$_Gconfig['specialListingWhereFullArbo']['nomTable'] = 'nomFonction';
</code>