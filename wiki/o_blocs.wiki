<h1>Plugin o_blocs</h1>

<h2>Installation du plugin</h2>



<h2>Créer un bloc</h2>

Se rendre dans l'administration et rajouter dans l'url le paramètre _"?curTable=s_bloc"_.
Cliquez sur _Ajouter un élément_.

[http://www.opixido.com/ocms/screen/plugins/o_bloc-creer.png]
<ul>
<li>Donnez un nom au bloc</li>
<li>Écrire une condition quand à son affichage (facultatif)</li>
<li>Donnez un nom de classe (facultatif)</li>
<li>Rendez-le visible</li>
</ul>

<h2>Affichage</h2>

Pou afficher dans le layout ce que contient le bloc, modifiez le fichier _default.html.php_ du dossier _include/exports/_, et ajoutez à l'endroit voulu :
<code language="php">
<div id="bloc-droite">

<?php
  //Remplacez "nomBloc" par le nom que vous lui avez donné lors de sa création
  echo $this->plugins['o_blocs']->nomBloc->genBloc(); 
?>

</div>
</code>

<h2>Ajouter un contenu</h2>

Vous pouvez ajouter du contenu dans ce bloc en appelant la fonction _add()_ *dans la fonction _init()_* :
<code language="php">
public function init()
{
 //do something
 if($ok)
 {
  $this->site->plugins['o_blocs']->blocs[nomBloc]->add('idBloc',  $this->genDownloads(),'');
 }
}
</code>

Exemple, dans le plugin _"ocms_downloads"_ :

<code language="php">
class ocms_downloadFront extends ocmsPlugin
{
 public function afterInit()
 {
  $this->downloads = $this->getDownloads();
		
  if($this->downloads)
  {
   $this->site->plugins['o_blocs']->blocs['droite']->add('downloads',$this->genDownloads());
  }
 }

 public function genDownloads()
 {
  $tpl = new genTemplate();
  $tpl->loadTemplate('download_box','plugins/ocms_download/tpl');
  foreach($this->downloads as $row)
  {
   $stpl = $tpl->addBlock('DOWNLOAD');
   $d = new row('p_download',$row);
   $stpl->nom = $d->download_titre;
   $stpl->url = $d->download_fichier;
  }
  return $tpl->gen();
 }
}
</code>